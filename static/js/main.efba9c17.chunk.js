(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{22:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),o=n(11),r=(n(20),n(21),n(22),n(2)),s=n(4),i=n.n(s),l=n(6),u=n(3),d=n.n(u),b="https://mate.academy/students-api";function j(e){return new Promise((function(t){setTimeout(t,e)}))}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:t};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),j(300).then((function(){return fetch(b+e,c)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var m=function(e){return f(e)},p=function(e,t){return f(e,"POST",t)},O=function(e,t){return f(e,"PATCH",t)},h=function(e){return f(e,"DELETE")},x=function(){var e=Object(l.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,c=t.name,e.abrupt("return",p("/users",{email:n,name:c}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=n(0),g=function(e){var t=e.onLogin,n=Object(c.useState)(""),a=Object(r.a)(n,2),o=a[0],s=a[1],u=Object(c.useState)(""),b=Object(r.a)(u,2),j=b[0],f=b[1],m=Object(c.useState)(!1),p=Object(r.a)(m,2),O=p[0],h=p[1],g=Object(c.useState)(!1),N=Object(r.a)(g,2),T=N[0],k=N[1],C=Object(c.useState)(""),S=Object(r.a)(C,2),_=S[0],E=S[1],w=function(e){localStorage.setItem("user",JSON.stringify(e)),t(e)};Object(c.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(c){}}),[]);var I=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(o);case 2:(t=e.sent)?w(t):h(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),E(""),k(!0),e.prev=3,!O){e.next=9;break}return e.next=7,v({name:j,email:o}).then(w);case 7:e.next=11;break;case 9:return e.next=11,I();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),E("Something went wrtong");case 16:return e.prev=16,k(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(y.jsxs)("form",{onSubmit:L,className:"box mt-5",children:[Object(y.jsx)("h1",{className:"title is-3",children:O?"You need to register":"Log in to open todos"}),Object(y.jsxs)("div",{className:"field",children:[Object(y.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(y.jsxs)("div",{className:d()("control has-icons-left",{"is-loading":T}),children:[Object(y.jsx)("input",{type:"email",id:"user-email",className:d()("input",{"is-danger":!O&&_}),placeholder:"Enter your email",disabled:T||O,value:o,required:!0,onChange:function(e){return s(e.target.value)}}),Object(y.jsx)("span",{className:"icon is-small is-left",children:Object(y.jsx)("i",{className:"fas fa-envelope"})})]}),!O&&_&&Object(y.jsx)("p",{className:"help is-danger",children:_})]}),O&&Object(y.jsxs)("div",{className:"field",children:[Object(y.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(y.jsxs)("div",{className:d()("control has-icons-left",{"is-loading":T}),children:[Object(y.jsx)("input",{type:"text",id:"user-name",className:d()("input",{"is-danger":O&&_}),placeholder:"Enter your name",required:!0,minLength:4,disabled:T,value:j,onChange:function(e){return f(e.target.value)}}),Object(y.jsx)("span",{className:"icon is-small is-left",children:Object(y.jsx)("i",{className:"fas fa-user"})})]}),O&&_&&Object(y.jsx)("p",{className:"help is-danger",children:_})]}),Object(y.jsx)("div",{className:"field",children:Object(y.jsx)("button",{type:"submit",className:d()("button is-primary",{"is-loading":T}),children:O?"Register":"Login"})})]})},N=a.a.createContext(null),T=function(e){var t=e.children,n=Object(c.useState)(null),a=Object(r.a)(n,2),o=a[0],s=a[1];return o?Object(y.jsx)(N.Provider,{value:o,children:t}):Object(y.jsx)(g,{onLogin:s})},k=function(e){var t=e.onCloseError,n=e.unableAddTodo,c=e.unableEmptyTitle,a=e.unableDeleteTodo,o=e.unableUpdateTodo;return Object(y.jsxs)("div",{"data-cy":"ErrorNotification",className:"notification is-danger is-light has-text-weight-normal",children:[Object(y.jsx)("button",{"data-cy":"HideErrorButton",type:"button",className:"delete",onClick:function(){t()}}),(n||c)&&"Unable to add a todo",a&&"Unable to delete a todo",o&&"Unable to update a todo"]})},C=function(e){var t=e.todos,n=e.setTodos,a=e.filterBy,o=e.setfilterBy,r=Object(c.useCallback)((function(){t.map((function(e){return e.completed?h("/todos/".concat(e.id)):e})),n((function(e){return e.filter((function(e){return!e.completed}))}))}),[t]);return Object(y.jsxs)("footer",{className:"todoapp__footer","data-cy":"Footer",children:[Object(y.jsx)("span",{className:"todo-count","data-cy":"todosCounter",children:"".concat(t.filter((function(e){return!0!==e.completed})).length," items left")}),Object(y.jsxs)("nav",{className:"filter","data-cy":"Filter",children:[Object(y.jsx)("a",{"data-cy":"FilterLinkAll",href:"#/",className:d()("filter__link",{selected:"all"===a}),onClick:function(){return o("all")},children:"All"}),Object(y.jsx)("a",{"data-cy":"FilterLinkActive",href:"#/active",className:d()("filter__link",{selected:"active"===a}),onClick:function(){return o("active")},children:"Active"}),Object(y.jsx)("a",{"data-cy":"FilterLinkCompleted",href:"#/completed",className:d()("filter__link",{selected:"completed"===a}),onClick:function(){return o("completed")},children:"Completed"})]}),Object(y.jsx)("button",{"data-cy":"ClearCompletedButton",type:"button",className:d()("todoapp__clear-completed",{hidden:!t.some((function(e){return e.completed}))}),onClick:function(){return r()},disabled:!t.some((function(e){return e.completed})),children:"Clear completed"})]})},S=n(9),_=n(5),E=function(e){var t=e.todos,n=e.setSelectedTodoId,a=e.setIsLoading,o=e.setTodos,s=e.setUnableAddTodo,i=e.setUnableEmptyTitle,l=Object(c.useState)(!1),u=Object(r.a)(l,2),d=u[0],b=u[1],j=Object(c.useState)(""),f=Object(r.a)(j,2),m=f[0],h=f[1],x=Object(c.useContext)(N),v=Object(c.useRef)(null),g=Object(c.useCallback)((function(){a(!0),x&&m.trim().length&&p("/todos",{title:m,userId:null===x||void 0===x?void 0:x.id,completed:!1}).then((function(e){o((function(t){return[].concat(Object(_.a)(t),[e])})),n([e.id])})).catch((function(){return s(!0)})).finally((function(){setTimeout((function(){a(!1),n([])}),500)})),h("")}),[m]),T=Object(c.useCallback)((function(){a(!0),n(Object(_.a)(t.map((function(e){return e.id})))),b(!d),t.map((function(e){return O("/todos/".concat(e.id),{completed:d})})),o((function(e){return e.map((function(e){return Object(S.a)(Object(S.a)({},e),{},{completed:d})}))})),setTimeout((function(){a(!1)}),300)}),[d,t]);return Object(c.useEffect)((function(){v.current&&v.current.focus()}),[]),Object(y.jsxs)("header",{className:"todoapp__header",children:[Object(y.jsx)("button",{"data-cy":"ToggleAllButton",type:"button",className:"todoapp__toggle-all active",onClick:function(){return T()}}),Object(y.jsx)("form",{onSubmit:function(e){e.preventDefault(),m.trim().length||(i(!0),setTimeout((function(){return i(!1)}),1500)),g()},children:Object(y.jsx)("input",{"data-cy":"NewTodoField",type:"text",ref:v,className:"todoapp__new-todo",placeholder:"What needs to be done?",value:m,onChange:function(e){return h(e.target.value)},onBlur:function(){g()}})})]})},w=function(){return Object(y.jsxs)("div",{"data-cy":"TodoLoader",className:"modal overlay is-active",children:[Object(y.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(y.jsx)("div",{className:"loader"})]})},I=function(e){var t=e.todos,n=e.selectedTodoId,a=e.setSelectedTodoId,o=e.setIsLoading,s=e.isLoading,i=e.filterBy,l=e.setTodos,u=e.setUnableUpdateTodo,b=e.setunableDeleteTodo,j=Object(c.useState)(!1),f=Object(r.a)(j,2),m=f[0],p=f[1],x=Object(c.useState)(""),v=Object(r.a)(x,2),g=v[0],N=v[1],T=Object(c.useRef)(null),k=Object(c.useCallback)((function(e,t){o(!0),a([e]),O("/todos/".concat(e),{completed:!t}).then((function(e){return l((function(t){return[].concat(Object(_.a)(t.slice(0,t.findIndex((function(t){return t.id===e.id})))),[e],Object(_.a)(t.slice(t.findIndex((function(t){return t.id===e.id}))+1)))}))})).catch((function(){return u(!0)})).finally((function(){return o(!1)}))}),[n]),C=Object(c.useCallback)((function(e){o(!0),a([e]),h("/todos/".concat(e)).then((function(t){1===t&&(l((function(t){return t.filter((function(t){return t.id!==e}))})),a([]))})).catch((function(){return b(!0)})).finally((function(){return o(!1)}))}),[n]),S=Object(c.useCallback)((function(e){a([e]),o(!0),O("/todos/".concat(e),{title:g}).then((function(e){l((function(t){return[].concat(Object(_.a)(t.slice(0,t.findIndex((function(t){return t.id===e.id})))),[e],Object(_.a)(t.slice(t.findIndex((function(t){return t.id===e.id}))+1)))}))})).finally((function(){return setTimeout((function(){return o(!1)}),500)})),N(""),p(!1)}),[g]);Object(c.useEffect)((function(){var e;m&&(null===(e=T.current)||void 0===e||e.focus())}),[m]);var E=Object(c.useMemo)((function(){return t.filter((function(e){switch(i){case"active":return!e.completed;case"completed":return e.completed;default:return e}}))}),[i,t]);return Object(y.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:E.map((function(e){return Object(y.jsxs)("div",{"data-cy":"Todo",className:d()("todo",{completed:e.completed}),children:[Object(y.jsx)("label",{className:"todo__status-label",children:Object(y.jsx)("input",{"data-cy":"TodoStatus",type:"checkbox",className:"todo__status",onChange:function(){return k(e.id,e.completed)}})}),Object(y.jsx)("span",{"data-cy":"TodoTitle",className:"todo__title",onDoubleClick:function(){a([e.id]),N(e.title),p(!0)},children:m&&n.includes(e.id)?Object(y.jsx)("form",{onSubmit:function(t){t.preventDefault(),S(e.id)},children:Object(y.jsx)("input",{type:"text",ref:T,className:"todoapp__edit-todo",value:g,onChange:function(e){return N(e.target.value)},onBlur:function(){return S(e.id)}})}):e.title}),!m&&Object(y.jsx)("button",{type:"button",className:"todo__remove","data-cy":"TodoDeleteButton",onClick:function(){a([e.id]),C(e.id)},children:"\xd7"}),s&&n.includes(e.id)&&Object(y.jsx)(w,{})]},e.id)}))})},L=function(){var e=Object(c.useState)([]),t=Object(r.a)(e,2),n=t[0],a=t[1],o=Object(c.useState)(""),s=Object(r.a)(o,2),i=s[0],l=s[1],u=Object(c.useState)(!1),d=Object(r.a)(u,2),b=d[0],j=d[1],f=Object(c.useState)(!1),p=Object(r.a)(f,2),O=p[0],h=p[1],x=Object(c.useState)(!1),v=Object(r.a)(x,2),g=v[0],T=v[1],S=Object(c.useState)(!1),_=Object(r.a)(S,2),w=_[0],L=_[1],U=Object(c.useState)(!1),B=Object(r.a)(U,2),A=B[0],D=B[1],F=Object(c.useState)([]),J=Object(r.a)(F,2),P=J[0],R=J[1],q=Object(c.useContext)(N);Object(c.useEffect)((function(){q&&m("/todos?userId=".concat(q.id)).then(a)}),[]);var H=Object(c.useCallback)((function(){j(!1),L(!1),h(!1),T(!1),D(!1)}),[]);return Object(y.jsxs)("div",{className:"todoapp",children:[Object(y.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(y.jsxs)("div",{className:"todoapp__content",children:[Object(y.jsx)(E,{todos:n,setSelectedTodoId:R,setIsLoading:D,setTodos:a,setUnableAddTodo:j,setUnableEmptyTitle:L}),Object(y.jsx)(I,{selectedTodoId:P,setSelectedTodoId:R,todos:n,setIsLoading:D,isLoading:A,setTodos:a,setUnableUpdateTodo:T,setunableDeleteTodo:h,filterBy:i}),n.length>0&&Object(y.jsx)(C,{todos:n,setTodos:a,filterBy:i,setfilterBy:l})]}),(b||O||g||w)&&Object(y.jsx)(k,{onCloseError:H,unableAddTodo:b,unableEmptyTitle:w,unableDeleteTodo:O,unableUpdateTodo:g})]})},U=function(){return Object(y.jsx)(T,{children:Object(y.jsx)(L,{})})};Object(o.createRoot)(document.getElementById("root")).render(Object(y.jsx)(U,{}))}},[[25,1,2]]]);
//# sourceMappingURL=main.efba9c17.chunk.js.map